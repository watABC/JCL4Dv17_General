  //JCL_fields_import_Tables  //20200225 wat  //fields読込、テーブル名の配列を得る、日本語名と説明もC_TEXT($1;$inFileText)$inFileText:=$1  //読み込んだファイルの中身C_POINTER($2;$outAryTableNamePtr)$outAryTableNamePtr:=$2  //テーブル名C_POINTER($3;$outAryStartLineNrPtr)$outAryStartLineNrPtr:=$3  //テーブル定義始まりの行番号C_POINTER($4;$outAryPrefixPtr)$outAryPrefixPtr:=$4  //フィールド名のプリフィックスC_POINTER($5;$outAryTablLabelPtr)$outAryTablLabelPtr:=$5  // テーブル日本語名C_POINTER($6;$outAryTableDescriPtr)$outAryTableDescriPtr:=$6  // テーブル説明C_LONGINT($0;$cnt)ARRAY TEXT($lineAry;0)ARRAY TEXT($itemAry;0)C_LONGINT($numOfLines;$numOfItems)  //改行で切り分ける$numOfLines:=JCL_str_Extract ($inFileText;Char(Carriage return);->$lineAry)  //最初のテーブル名を取得$numOfItems:=JCL_str_Extract ($lineAry{1};Char(Tab);->$itemAry)APPEND TO ARRAY($outAryTableNamePtr->;$itemAry{1})APPEND TO ARRAY($outAryPrefixPtr->;$itemAry{2})  // 使うときに＿をつけるAPPEND TO ARRAY($outAryTablLabelPtr->;$itemAry{6})  // テーブル名APPEND TO ARRAY($outAryTableDescriPtr->;$itemAry{7})  //テーブル説明APPEND TO ARRAY($outAryStartLineNrPtr->;1)$cnt:=$cnt+1  //ヘッダなし、１行目からテーブル名を探すFor ($i;2;$numOfLines-1)		DELETE FROM ARRAY($itemAry;1;Size of array($itemAry))	$numOfItems:=JCL_str_Extract ($lineAry{$i};Char(Tab);->$itemAry)	If ($itemAry{1}="_")		  //＿（アンダースコア）の次の行からテーブル名を取得		DELETE FROM ARRAY($itemAry;1;Size of array($itemAry))		$numOfItems:=JCL_str_Extract ($lineAry{$i+1};Char(Tab);->$itemAry)		If ($itemAry{1}#"")						APPEND TO ARRAY($outAryTableNamePtr->;$itemAry{1})			APPEND TO ARRAY($outAryPrefixPtr->;$itemAry{2})  // 使うときに＿をつける			APPEND TO ARRAY($outAryTablLabelPtr->;$itemAry{6})  // テーブル名			APPEND TO ARRAY($outAryTableDescriPtr->;$itemAry{7})  //テーブル説明			APPEND TO ARRAY($outAryStartLineNrPtr->;$i+1)			$cnt:=$cnt+1					End if 	End if End for $0:=$cnt