  //JCL_fields_Import  //20200216 wat  //fieldsの内容をテキストフィアルから読み込んで、FIELDSテーブルに保存  //自力ユーザ検索を実装するため、フィールド名、テーブル名の日本語表示用C_LONGINT($0;$dlgOk)C_BLOB($fileBlob)  //読み込んだファイルの内容C_TEXT($fileText)  //読み込んだファイルARRAY TEXT($aryTableName;0)  //テーブル名ARRAY LONGINT($aryStartLineNr;0)  //テーブル定義始まりの行番号ARRAY TEXT($aryPrefix;0)  //フィールド名のプリフィックスARRAY TEXT($aryTablLabel;0)  //テーブル日本語名ARRAY TEXT($aryTablDescri;0)  //テーブル説明C_LONGINT($i;$numOfTables)  //定義ファイルを選択$dlgOk:=JCL_file_SelectFileDlg (->$fileBlob)If ($dlgOk=1)		  //読み込んだファイルの内容を4Dの文字セットにエンコード	$fileText:=Convert to text($fileBlob;"UTF-8")	  //$errCnt:=JCL_fields_Import_checkData($fileText)		  //テーブル名の配列を得る	$numOfTables:=JCL_fields_import_Tables ($fileText;->$aryTableName;->$aryStartLineNr;->$aryPrefix;->$aryTablLabel;->$aryTablDescri)	For ($i;1;$numOfTables)		  //テーブル名、フィールド名、ラベルを保存		JCL_fields_Import_flds ($fileText;$aryTableName{$i};$aryStartLineNr{$i};$aryPrefix{$i};$aryTablLabel{$i};$aryTablDescri{$i})			End for 		C_TEXT($msg)	$msg:="完了"+Char(Carriage return)	$msg:=$msg+String($numOfTables)+"個のテーブルについてfields情報を取り込みました。"	ALERT($msg)	End if $0:=$dlgOk