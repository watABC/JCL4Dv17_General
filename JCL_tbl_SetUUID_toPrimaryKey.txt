  //JCL_tbl_SetUUID_toPrimaryKey  //20191106 from 4D Japan Knowledge Base  //UUIDのプライマリーキーを全て更新して新しいUUIDをセットする  //20191106 v17対応、癸生川さん  //参考記事URL  ///blog/tech-tips-2014-07-28.html#anchor4JCL_pgs_DefInit   //jiroJCL_pgs_Show ("プライマリーキーフィールドにUUIDを保存しています...")  //jiro  // プライマリーキーをもった全テーブルのテーブル番号を配列化ARRAY LONGINT($pk_TableIDs;0)Begin SQL	SELECT TABLE_ID	FROM _USER_CONSTRAINTS 	WHERE CONSTRAINT_TYPE = 'P' 	INTO :$pk_TableIDs;End SQL  // プライマリーキーをもった全テーブルに対してループして処理するC_LONGINT($i)  //ループ用C_LONGINT($table_id)  //テーブル番号C_TEXT($tableName)C_POINTER($table_p)  //テーブルポインタC_LONGINT($field_id)  //フィールド番号（プライマリーキーフィールド用）C_POINTER($field_p)  //フィールドポインタC_LONGINT($i;1;$sizeOfAry)$sizeOfAry:=Size of array($pk_TableIDs)For ($i;1;$sizeOfAry)	$table_id:=$pk_TableIDs{$i}	  //プログレスバー jiro	$tableName:=Table name($table_id)	JCL_pgs_SetValue (($i/$sizeOfAry)*100;String($i)+"テーブル："+$tableName;$i;$sizeOfAry)	DELAY PROCESS(Current process;1)		  //プライマリーキーフィールドの番号を得る	Begin SQL		SELECT COLUMN_ID		FROM _USER_CONS_COLUMNS		WHERE TABLE_ID = :$table_id		INTO :$field_id;	End SQL		  //プライマリーキーのフィールドタイプが文字列ならUUIDとして全レコードを更新	If (Type(Field($table_id;$field_id)->)=Is alpha field)		PAUSE INDEXES(Table($table_id)->)  //インデックス作成を中断		ALL RECORDS(Table($table_id)->)		$table_p:=Table($table_id)		$field_p:=Field($table_id;$field_id)		APPLY TO SELECTION($table_p->;$field_p->:=Generate UUID)  //ロックされ更新できなかったレコードに注意		RESUME INDEXES(Table($table_id)->)  //インデックス作成を再開			End if 	$done:=JCL_pgs_IsCancel   //jiro	If ($done=True)		$i:=$sizeOfAry	End if End for JCL_pgs_Close   //jiro