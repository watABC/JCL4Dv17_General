  //JCL_fields_Import_flds  //20200217 wat  //fieldsの内容をテキストフィアルから読み込んで、FIELDSテーブルに保存C_TEXT($1;$inFileText)$inFileText:=$1  //読み込んだファイルの中身C_TEXT($2;$inTableName)$inTableName:=$2  //テーブル名C_LONGINT($3;$inStartLineNr)$inStartLineNr:=$3  //テーブル定義始まりの行番号,スタート行番号C_TEXT($4;$inPrefix)$inPrefix:=$4  //フィールドのプリフィックスC_TEXT($5;$inTableLabel)$inTableLabel:=$5  //テーブル日本語名C_TEXT($6;$inTableDescri)$inTableDescri:=$6  //テーブル説明C_LONGINT($0;$cnt)ARRAY TEXT($lineAry;0)ARRAY TEXT($itemAry;0)C_LONGINT($numOfLines;$numOfItems)  //改行で切り分ける$numOfLines:=JCL_str_Extract ($inFileText;Char(Carriage return);->$lineAry)For ($i;$inStartLineNr+1;$numOfLines)	  //スタート行番号の次の行からフィールド定義を得る	DELETE FROM ARRAY($itemAry;1;Size of array($itemAry))	$numOfItems:=JCL_str_Extract ($lineAry{$i};Char(Tab);->$itemAry)	If (8>=$numOfItems)		If ($itemAry{1}#"_")			  //最初のセルが＿（アンダーバー）じゃなかったらフィールド情報取得、保存			READ WRITE([z_Fields])			FL_Add_byInitValues 			[z_Fields]FL_TABLE_NAME:=$inTableName			$itemAry{1}:=Replace string($itemAry{1};" ";"_")			[z_Fields]FL_FIELD_NAME:=$inPrefix+"_"+$itemAry{1}			[z_Fields]FL_DATA_TYPE:=$itemAry{2}			[z_Fields]FL_LENGTH:=Num($itemAry{3})			[z_Fields]FL_INDEX:=Num($itemAry{4})			[z_Fields]FL_UNIQUE:=Num($itemAry{5})			[z_Fields]FL_LABEL:=$itemAry{6}			[z_Fields]FL_COMMENT:=$itemAry{7}			[z_Fields]FL_REMARK:=$itemAry{8}			[z_Fields]FL_TABLE_LABEL:=$inTableLabel			[z_Fields]FL_TABLE_DESCRIPTION:=$inTableDescri			SAVE RECORD([z_Fields])			UNLOAD RECORD([z_Fields])			READ ONLY([z_Fields])					Else 			  //最初のセルが＿（アンダーバー）だったらフィールド情報取得は終わり			$i:=$numOfLines+1  //ループを抜ける					End if 	Else 		$i:=$numOfLines+1  //ループを抜ける			End if End for   //ALERT("end.")$0:=$cnt